(function(b,a,d){function c(f){f=f||{guess:true};var g=f.e||null,i=!!f.guess;var h=new c.implementation(),e=h.run(g);return(i)?h.guessAnonymousFunctions(e):e;}c.implementation=function(){};c.implementation.prototype={run:function(e,f){e=e||this.createException();f=f||this.mode(e);if(f==="other"){return this.other(arguments.callee);}else{return this[f](e);}},createException:function(){try{this.undef();}catch(f){return f;}},mode:function(f){if(f["arguments"]&&f.stack){return"chrome";}else{if(typeof f.message==="string"&&typeof b!=="undefined"&&b.opera){if(!f.stacktrace){return"opera9";}if(f.message.indexOf("\n")>-1&&f.message.split("\n").length>f.stacktrace.split("\n").length){return"opera9";}if(!f.stack){return"opera10a";}if(f.stacktrace.indexOf("called from line")<0){return"opera10b";}return"opera11";}else{if(f.stack){return"firefox";}}}return"other";},instrumentFunction:function(f,h,i){f=f||b;var e=f[h];f[h]=function g(){i.call(this,c().slice(4));return f[h]._instrumented.apply(this,arguments);};f[h]._instrumented=e;},deinstrumentFunction:function(e,f){if(e[f].constructor===Function&&e[f]._instrumented&&e[f]._instrumented.constructor===Function){e[f]=e[f]._instrumented;}},chrome:function(g){var f=(g.stack+"\n").replace(/^\S[^\(]+?[\n$]/gm,"").replace(/^\s+(at eval )?at\s+/gm,"").replace(/^([^\(]+?)([\n$])/gm,"{anonymous}()@$1$2").replace(/^Object.<anonymous>\s*\(([^\)]+)\)/gm,"{anonymous}()@$1").split("\n");f.pop();return f;},firefox:function(f){return f.stack.replace(/(?:\n@:0)?\s+$/m,"").replace(/^\(/gm,"{anonymous}(").split("\n");},opera11:function(l){var f="{anonymous}",m=/^.*line (\d+), column (\d+)(?: in (.+))? in (\S+):$/;var o=l.stacktrace.split("\n"),p=[];for(var h=0,k=o.length;h<k;h+=2){var j=m.exec(o[h]);if(j){var n=j[4]+":"+j[1]+":"+j[2];var g=j[3]||"global code";g=g.replace(/<anonymous function: (\S+)>/,"$1").replace(/<anonymous function>/,f);p.push(g+"@"+n+" -- "+o[h+1].replace(/^\s+/,""));}}return p;},opera10b:function(m){var l=/^(.*)@(.+):(\d+)$/;var h=m.stacktrace.split("\n"),g=[];for(var k=0,f=h.length;k<f;k++){var j=l.exec(h[k]);if(j){var n=j[1]?(j[1]+"()"):"global code";g.push(n+"@"+j[2]+":"+j[3]);}}return g;},opera10a:function(l){var f="{anonymous}",m=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i;var n=l.stacktrace.split("\n"),o=[];for(var h=0,k=n.length;h<k;h+=2){var j=m.exec(n[h]);if(j){var g=j[3]||f;o.push(g+"()@"+j[2]+":"+j[1]+" -- "+n[h+1].replace(/^\s+/,""));}}return o;},opera9:function(n){var j="{anonymous}",m=/Line (\d+).*script (?:in )?(\S+)/i;var h=n.message.split("\n"),g=[];for(var l=2,f=h.length;l<f;l+=2){var k=m.exec(h[l]);if(k){g.push(j+"()@"+k[2]+":"+k[1]+" -- "+h[l+1].replace(/^\s+/,""));}}return g;},other:function(k){var f="{anonymous}",j=/function\s*([\w\-$]+)?\s*\(/i,e=[],h,g,i=10;while(k&&k["arguments"]&&e.length<i){h=j.test(k.toString())?RegExp.$1||f:f;g=Array.prototype.slice.call(k["arguments"]||[]);e[e.length]=h+"("+this.stringifyArguments(g)+")";k=k.caller;}return e;},stringifyArguments:function(g){var f=[];var j=Array.prototype.slice;for(var h=0;h<g.length;++h){var e=g[h];if(e===d){f[h]="undefined";}else{if(e===null){f[h]="null";}else{if(e.constructor){if(e.constructor===Array){if(e.length<3){f[h]="["+this.stringifyArguments(e)+"]";}else{f[h]="["+this.stringifyArguments(j.call(e,0,1))+"..."+this.stringifyArguments(j.call(e,-1))+"]";}}else{if(e.constructor===Object){f[h]="#object";}else{if(e.constructor===Function){f[h]="#function";}else{if(e.constructor===String){f[h]='"'+e+'"';}else{if(e.constructor===Number){f[h]=e;}}}}}}}}}return f.join(",");},sourceCache:{},ajax:function(f){var g=this.createXMLHTTPObject();if(g){try{g.open("GET",f,false);g.send(null);return g.responseText;}catch(h){}}return"";},createXMLHTTPObject:function(){var h,f=[function(){return new XMLHttpRequest();},function(){return new ActiveXObject("Msxml2.XMLHTTP");},function(){return new ActiveXObject("Msxml3.XMLHTTP");},function(){return new ActiveXObject("Microsoft.XMLHTTP");}];for(var g=0;g<f.length;g++){try{h=f[g]();this.createXMLHTTPObject=f[g];return h;}catch(j){}}},isSameDomain:function(e){return typeof location!=="undefined"&&e.indexOf(location.hostname)!==-1;},getSource:function(e){if(!(e in this.sourceCache)){this.sourceCache[e]=this.ajax(e).split("\n");}return this.sourceCache[e];},guessAnonymousFunctions:function(p){for(var l=0;l<p.length;++l){var k=/\{anonymous\}\(.*\)@(.*)/,q=/^(.*?)(?::(\d+))(?::(\d+))?(?: -- .+)?$/,f=p[l],g=k.exec(f);if(g){var j=q.exec(g[1]);if(j){var h=j[1],e=j[2],o=j[3]||0;if(h&&this.isSameDomain(h)&&e){var n=this.guessAnonymousFunction(h,e,o);p[l]=f.replace("{anonymous}",n);}}}}return p;},guessAnonymousFunction:function(h,j,f){var g;try{g=this.findFunctionName(this.getSource(h),j);}catch(i){g="getSource failed with url: "+h+", exception: "+i.toString();}return g;},findFunctionName:function(e,j){var l=/function\s+([^(]*?)\s*\(([^)]*)\)/;var p=/['"]?([0-9A-Za-z_]+)['"]?\s*[:=]\s*function\b/;var n=/['"]?([0-9A-Za-z_]+)['"]?\s*[:=]\s*(?:eval|new Function)\b/;var f="",q,o=Math.min(j,20),h,g;for(var k=0;k<o;++k){q=e[j-k-1];g=q.indexOf("//");if(g>=0){q=q.substr(0,g);}if(q){f=q+f;h=p.exec(f);if(h&&h[1]){return h[1];}h=l.exec(f);if(h&&h[1]){return h[1];}h=n.exec(f);if(h&&h[1]){return h[1];}}}return"(?)";}};(function(){var g='<?xml version="1.0" encoding="UTF-8"?><notice version="2.0"><api-key>{key}</api-key><notifier><name>airbrake_js</name><version>0.2.0</version><url>http://airbrake.io</url></notifier><error><class>{exception_class}</class><message>{exception_message}</message><backtrace>{backtrace_lines}</backtrace></error><request><url>{request_url}</url><component>{request_component}</component><action>{request_action}</action>{request}</request><server-environment><project-root>{project_root}</project-root><environment-name>{environment}</environment-name></server-environment></notice>',i="<{group_name}>{inner_content}</{group_name}>",m='<var key="{key}">{value}</var>',h='<line method="{method}" file="{file}" number="{number}" />',f,e,k,l;k={merge:(function(){function n(p,o,q){if(q.hasOwnProperty(p)){o[p]=q[p];}}return function(){var q=Array.prototype.slice.call(arguments),r,p,o={};while(r=q.shift()){for(p in r){n(p,o,r);}}return o;};})(),escape:function(n){return n.replace(/&/g,"&#38;").replace(/</g,"&#60;").replace(/>/g,"&#62;").replace(/'/g,"&#39;").replace(/"/g,"&#34;");},trim:function(n){return n.toString().replace(/^\s+/,"").replace(/\s+$/,"");},substitute:function(p,o,n){return p.replace(/{([\w_.-]+)}/g,function(q,r){return(r in o)?o[r]:(n?"":q);});},substituteArr:function(s,p,r){var q=0,n=0,o="";for(q=0,n=p.length;q<n;q+=1){o+=this.substitute(s,p[q],r);}return o;},processjQueryEventHandlerWrapping:function(){if(f.options.trackJQ===true){f.jQuery_fn_on_original=f.jQuery_fn_on_original||jQuery.fn.on;jQuery.fn.on=function(){var n=Array.prototype.slice.call(arguments),o=4;while((--o>-1)&&(typeof n[o]!=="function")){}if(o===-1){return f.jQuery_fn_on_original.apply(this,arguments);}n[o]=(function(p){return function(){try{p.apply(this,arguments);}catch(q){e.captureException(q);}};})(n[o]);return f.jQuery_fn_on_original.apply(this,n);};}else{(typeof f.jQuery_fn_on_original==="function")&&(jQuery.fn.on=f.jQuery_fn_on_original);}},isjQueryPresent:function(){return(typeof jQuery==="function")&&("fn" in jQuery)&&("jquery" in jQuery.fn)&&(jQuery.fn.jquery.indexOf("1.7")===0);},capitalizeFirstLetter:function(n){return n[0].toUpperCase()+n.slice(1);},generatePublicAPI:(function(){function n(p,q,r){return function(s){r[q][p]=s;};}function o(p,q,r){return function(s){return r[q][p];};}return function(p,u){var t=0,q=null,s="",r={};for(t=0;t<p.length;t+=1){q=p[t];switch(true){case (typeof q.variable!=="undefined")&&(typeof q.methodName==="undefined"):s=k.capitalizeFirstLetter(q.variable);r["set"+s]=n(q.variable,q.namespace,u);r["get"+s]=o(q.variable,q.namespace,u);break;case (typeof q.methodName!=="undefined")&&(typeof q.method!=="undefined"):r[q.methodName]=q.method;break;default:}}return r;};}())};f={xmlData:{environment:"environment"},options:{trackJQ:false,host:"api.airbrake.io",errorDefaults:{},guessFunctionName:false,requestType:"POST",outputFormat:"XML"}};l=[{variable:"environment",namespace:"xmlData"},{variable:"key",namespace:"xmlData"},{variable:"host",namespace:"options"},{variable:"errorDefaults",namespace:"options"},{variable:"guessFunctionName",namespace:"options"},{variable:"requestType",namespace:"options"},{variable:"outputFormat",namespace:"options"},{methodName:"setTrackJQ",variable:"trackJQ",namespace:"options",method:(function(n){if(!k.isjQueryPresent()){throw Error("Please do not call 'Airbrake.setTrackJQ' if jQuery does't present");}n=!!n;if(f.options.trackJQ===n){return;}f.options.trackJQ=n;k.processjQueryEventHandlerWrapping();})},{methodName:"captureException",method:(function(n){new j().notify({message:n.message,stack:n.stack});})}];e=b.Airbrake=b.Hoptoad=k.generatePublicAPI(l,f);function j(){this.options=k.merge({},f.options);this.xmlData=k.merge(this.DEF_XML_DATA,f.xmlData);}j.prototype={constructor:j,VERSION:"0.2.0",ROOT:b.location.protocol+"//"+b.location.host,BACKTRACE_MATCHER:/^(.*)\@(.*)\:(\d+)$/,backtrace_filters:[/notifier\.js/],DEF_XML_DATA:{request:{}},notify:(function(){function o(p,r){var q=a.createElement("iframe");q.style.display="none";q.src=p+"?data="+r;q.onload=function(){setTimeout(function(){a.body.removeChild(q);},0);};a.body.appendChild(q);}function n(p,r){var q=new XMLHttpRequest();q.open("POST",p,true);q.send(r);}return function(r){var p="",q="http://"+this.options.host+"/notifier_api/v2/notices";switch(this.options.outputFormat){case"XML":p=escape(this.generateXML(this.generateJSON(r)));break;case"JSON":p=escape(JSON.stringify(this.generateJSON(r)));break;default:}switch(this.options.requestType){case"POST":n(q,p);break;case"GET":o(q,p);break;default:}};}()),generateJSON:(function(){function o(p){var q="",r=[];for(q in p){if(p.hasOwnProperty(q)){r.push({key:q,value:p[q]});}}return r;}function n(p,s){var t=0,q={},r="";for(t=0;t<p.length;t+=1){r=p[t];if(typeof s[r]!=="undefined"){q[r]=o(s[r]);}}return q;}return function(q){var p=this.xmlData,u=k.merge(this.options.errorDefaults,q),t=u.component||"",s=(u.url||""+location.hash),r=["cgi-data","params","session"],v=null;v={request_url:s,request_action:(u.action||""),request_component:t,request:(function(){if(s||t){u["cgi-data"]=u["cgi-data"]||{};u["cgi-data"].HTTP_USER_AGENT=navigator.userAgent;return k.merge(p.request,n(r,u));}else{return{};}}()),project_root:this.ROOT,exception_class:(u.type||"Error"),exception_message:(u.message||"Unknown error."),backtrace_lines:this.generateBacktrace(u)};p=k.merge(p,v);return p;};}()),generateXML:(function(){function n(q){var o="",p="";for(o in q){if(q.hasOwnProperty(o)){p+=k.substitute(i,{group_name:o,inner_content:k.substituteArr(m,q[o],true)},true);}}return p;}return function(o){o.request=n(o.request);o.backtrace_lines=k.substituteArr(h,o.backtrace_lines,true);return k.substitute(g,o,true);};}()),generateBacktrace:function(o){var n=[],q,p,s,r;o=o||{};if(typeof o.stack!=="string"){try{(0)();}catch(t){o.stack=t.stack;}}r=this.getStackTrace(o);for(p=0;p<r.length;p++){s=r[p].match(this.BACKTRACE_MATCHER);if(s&&this.validBacktraceLine(r[p])){q=s[2].replace(this.ROOT,"[PROJECT_ROOT]");if(p===0&&s[2].match(a.location.href)){n.push({method:"",file:"internal: ",number:""});}n.push({method:s[1],file:q,number:s[3]});}}return n;},getStackTrace:function(n){var o,p=c({e:n,guess:this.options.guessFunctionName});for(o=0;o<p.length;o++){if(p[o].match(/\:\d+$/)){continue;}if(p[o].indexOf("@")===-1){p[o]+="@unsupported.js";}p[o]+=":0";}return p;},validBacktraceLine:function(n){for(var o=0;o<this.backtrace_filters.length;o++){if(n.match(this.backtrace_filters[o])){return false;}}return true;},generateVariables:function(p){var o,n="";for(o in p){if(p.hasOwnProperty(o)){n+='<var key="'+k.escape(o)+'">'+k.escape(p[o])+"</var>";}}return n;}};b.onerror=function(p,o,n){setTimeout(function(){new j().notify({message:p,stack:"()@"+o+":"+n});},0);return true;};})();})(window,document);